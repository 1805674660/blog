<!--
 * @Author: your name
 * @Date: 2022-04-22 17:48:08
 * @LastEditTime: 2022-04-28 17:41:52
 * @LastEditors: Please set LastEditors
 * @Description: 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
 * @FilePath: \blog2\data-structure-and-algorithms\22.两数之和.html
-->
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		<title>JavaScript 数据结构与算法之美 - 合并算法</title>
	</head>
	<body></body>
	<script>
        // 固定算法 固定思路
        //思路：降数组一分为二 一次循环比较左右两边大小 谁小先显示
        // const A = [1,7,5,2,4,6,3]
        // const B = [2,4,6,1,3,5]
        const mergesort  = function(A, p, q, r) {
                const len = A.length
                if (len === 0)  return
                let A1 = A.slice(p,q)
                let A2 = A.slice(q,r)
                // A1.push(Number.MAX_SAFE_INTEGER)//追加哨兵 一个正无穷大的数就不用判断他们谁先循环完
                // A2.push(Number.MAX_SAFE_INTEGER)
                let res = 0
                for (let k= p, i = 0,j=0; k<r; k++) {
                        res += A1[i]<A2[j] ? (r-j+1) * A1[i] : 0
                        A[k] = A1[i]<A2[j]?A1[i++]:A2[j++]
                        // console.log(k);
                        // console.log(A[k]);
                }
                return res
        }
        // mergesort(B,0,3,6)
        // console.log(B);
        function merge_sort(A,p,r){
                if(r-p<2) return
                const q = Math.ceil((p+r)/2)
                // merge_sort(A,p,q)
                // merge_sort(A,q,r)
                // mergesort(A,p,q,r)
                return merge_sort(A,p,q) + merge_sort(A,q,r) + mergesort(A,p,q,r)
        }
        const A = [1,3,4,2,5]
        console.log(merge_sort(A,0,A.length));
        // merge_sort(A,0,A.length)
        // console.log(A);

        // 归并问题 求左边小于i值的和
        // const B = [2,4,6,1,3,5]
        function mergesort(arr,l, m, r){
                //开辟一个新数组
                const help = []
                let i = 0
                let p1 = l
                let p2 = m + 1
                let res = 0
                while(p1 <= m && p2 <= r){
                        res += arr[p1]<arr[p2] ? (r-p2+1) * arr[p1] : 0
                        help[i++] = arr[p1]<arr[p2] ? arr[p1++]:arr[p2++]
                }
                while (p1 <= m){
                        help[i++] = arr[p1++]
                }
                while (p2 <= r){
                        help[i++] = arr[p2++]
                }
                for (let i = 0; i < help.length; i++) {
                        arr[l+i] = help[i]
                        
                }
                return res
        }
        // mergesort(B,0,3,5)
        // console.log(B);

        function merge_sort(A,p,r){
                if(r-p<2) return
                const q = Math.floor((p+r)/2)
                // const q = p + ((r-l)>>1)
                // merge_sort(A,p,q)
                // merge_sort(A,q+1,r)
                // mergesort(A,p,q,r)
                return merge_sort(A,p,q) + merge_sort(A,q+1,r) + mergesort(A,p,q,r)
        }
        const A = [1,3,4,2,5]
        // merge_sort(A,0,A.length)
        // console.log(A);
        console.log(merge_sort(A,0,A.length-1));
        
	</script>
</html>
